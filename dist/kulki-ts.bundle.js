!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={BoardWidth:9,BoardHeight:9,TileSize:50};function o(t,e,n){var r=document.createElement("div");return r.style.position="absolute",r.style.left=t.toString()+"px",r.style.top=e.toString()+"px",r.style.width=(2*n).toString()+"px",r.style.height=(2*n).toString()+"px",r.style.borderRadius=n.toString()+"px",r}var i,s,l,a,u,c,p,d,h=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))},t.prototype.equalTo=function(t){return this.x==t.x&&this.y==t.y},t.prototype.toTuple=function(){return[this.x,this.y]},t}(),y=function(t){function e(e,n,r,o){var i=t.call(this,e,n)||this;return i.previous=r,i.toDest=i.distanceTo(o),i}return h(e,t),Object.defineProperty(e.prototype,"sum",{get:function(){return this.fromStart+this.toDest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previous",{set:function(t){this.prev=t,this.fromStart=null==t?0:t.fromStart+1},enumerable:!0,configurable:!0}),e.prototype.toPoint=function(){return new f(this.x,this.y)},e}(f),v=function(){function t(t,e,n){var r;for(this._points=[],this.found=!1,this.startPoint=new f(t[0],t[1]),this.destination=new f(e[0],e[1]),this.open=new Array,this.open.push(new y(this.startPoint.x,this.startPoint.y,null,this.destination)),this.closed=new Array;this.open.length>0;){if(r=this.open.shift(),this.closed.push(r),r.toPoint().equalTo(this.destination)){this.found=!0;break}for(var o=0,i=this.neigbors(r);o<i.length;o++){var s=i[o];if(n(s.x,s.y)){var l=this.nodeInArray(s,this.open);null!=l?s.sum<l.sum&&(this.open[this.open.indexOf(l)].prev=r):this.open.push(s)}}this.open.sort((function(t,e){return t.sum-e.sum}))}if(this.found){for(this.points.push(this.destination);null!=r.prev;)this.points.push(r),r=r.prev;this.points.push(r),this.points.reverse()}}return t.prototype.nodeInArray=function(t,e){var n=e.filter((function(e){return e.equalTo(t)}));return 1==n.length?n[0]:null},t.prototype.neigbors=function(t){for(var e=new Array,n=0,r=[[-1,0],[0,-1],[1,0],[0,1]];n<r.length;n++){var o=r[n],i=new f(t.x+o[0],t.y+o[1]);null==this.nodeInArray(i,this.closed)&&e.push(new y(i.x,i.y,t,this.destination))}return e},Object.defineProperty(t.prototype,"length",{get:function(){return this._points.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"points",{get:function(){return this._points},enumerable:!0,configurable:!0}),t}(),g=!1,m=null,b=0,x=[];function S(){return d[d[Math.floor(1+Math.random()*(Object.keys(d).filter((function(t){return!isNaN(parseInt(t))})).length-1))]]}function _(t,e){return t>=0&&t<r.BoardWidth&&e>=0&&e<r.BoardHeight&&l[t][e].color==d.Empty}!function(t){t[t.Empty=0]="Empty",t[t.gray=1]="gray",t[t.red=2]="red",t[t.green=3]="green",t[t.blue=4]="blue",t[t.teal=5]="teal",t[t.yellow=6]="yellow",t[t.pink=7]="pink"}(d||(d={}));var T=function(){function t(t,e,n,o){var i=this;this.x=t,this.y=e,this._div=function(t,e,n){var r=document.createElement("div");return r.style.position="absolute",r.style.left=t.toString()+"px",r.style.top=e.toString()+"px",r.style.width=n.toString()+"px",r.style.height=n.toString()+"px",r}(t,e,r.TileSize),this._div.classList.add("board-tile"),this._div.style.left=t*r.TileSize+"px",this._div.style.top=e*r.TileSize+"px",this._div.setAttribute("x",t.toString()),this._div.setAttribute("y",e.toString()),this._color=o|d.Empty,this._div.addEventListener("click",(function(){n(t,e),i.updatePathDisplay()})),this._div.addEventListener("mouseenter",this.updatePathDisplay.bind(this)),this._div.addEventListener("mouseleave",(function(){if(p==i){for(var t=0,e=x;t<e.length;t++){e[t].div.classList.remove("path")}x=[]}}))}return t.prototype.updatePathDisplay=function(){p=this;for(var t=0,e=x;t<e.length;t++){e[t].div.classList.remove("path")}if(x=[],null!=m&&m!=this)for(var n=0,r=new v([m.x,m.y],[this.x,this.y],_).points;n<r.length;n++){var o=r[n];l[o.x][o.y].div.classList.add("path"),x.push(l[o.x][o.y])}},Object.defineProperty(t.prototype,"div",{get:function(){return this._div},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._div.innerHTML="",this.marble=null,t!=d.Empty&&(this.marble=o(r.TileSize/4,r.TileSize/4,r.TileSize/4),this.marble.classList.add("marble"),this.marble.style.backgroundColor=d[t],this._div.appendChild(this.marble)),this._color=t},enumerable:!0,configurable:!0}),t}(),E={init:function(){document.getElementById("start-btn").addEventListener("click",E.start),m=null,c=document.getElementById("score-text"),E.updateScore(0),(s=document.getElementById("game-board")).innerHTML="",l=[];for(var t=0;t<r.BoardWidth;t++){l.push([]);for(var e=0;e<r.BoardHeight;e++)l[t].push(null)}E.createBoard(),E.nextBatch()},start:function(){g=!0,E.init()},over:function(){g=!1;for(var t=0,e=l;t<e.length;t++)for(var n=0,r=e[t];n<r.length;n++){r[n].div.classList.remove("board-tile")}a.innerHTML="KONIEC GRY",alert("Koniec gry! TwÃ³j wynik: "+b)},createBoard:function(){for(var t=0;t<r.BoardWidth;t++)for(var e=0;e<r.BoardHeight;e++){var n=new T(t,e,E.tileClicked);l[t][e]=n,s.appendChild(n.div)}for(var o=0;o<5;o++)E.placeAtRandomSpot(S())},nextBatch:function(){(a=document.getElementById("next-display")).innerHTML="",u=[];for(var t=0;t<3;t++){var e=S();u.push(e);var n=o(0,0,r.TileSize/4);n.classList.add("marble"),n.style.display="inline-block",n.style.position="initial",n.style.backgroundColor=d[e],n.style.margin="0 5px 0 5px",a.appendChild(n)}},nextRound:function(){for(var t=0,e=u;t<e.length;t++){var n=e[t];E.placeAtRandomSpot(n)}g&&(0!=E.freeTilesCount()?E.nextBatch():E.over())},freeTilesCount:function(){for(var t=0,e=0,n=l;e<n.length;e++)for(var r=0,o=n[e];r<o.length;r++){o[r].color==d.Empty&&t++}return t},placeAtRandomSpot:function(t){if(g){0==E.freeTilesCount()&&E.over();var e=Math.floor(Math.random()*r.BoardWidth),n=Math.floor(Math.random()*r.BoardHeight);l[e][n].color==d.Empty?(l[e][n].color=t,E.checkForFive(e,n)):E.placeAtRandomSpot(t)}},tileClicked:function(t,e){if(g)if(null==m)l[t][e].color!=d.Empty&&(m=l[t][e]).div.setAttribute("selected","");else if(l[t][e].color==d.Empty){if(!new v([m.x,m.y],[t,e],_).found)return;l[t][e].color=m.color,l[m.x][m.y].color=d.Empty,m.div.removeAttribute("selected"),m=null,E.checkForFive(t,e)||E.nextRound()}else m.div.removeAttribute("selected"),l[t][e]!=m?(m=l[t][e]).div.setAttribute("selected",""):m=null},checkForFive:function(t,e){var n=l[t][e].color;if(n!=d.Empty){var o=function(t,e,n){return t>=0&&t<r.BoardWidth&&e>=0&&e<r.BoardHeight&&l[t][e].color==n},i=[],s=function(r,l,a,u){u&&i.push([t,e]);for(var c=1,p=r,d=l;o(t+p,e+d,n);)u&&i.push([t+p,e+d]),c++,p+=r,d+=l;for(p=r=-r,d=l=-l;o(t+p,e+d,n);)u&&i.push([t+p,e+d]),c++,p+=r,d+=l;c>=5&&!u&&s(r,l,a,!0)};s(-1,-1,n),s(-1,0,n),s(-1,1,n),s(0,-1,n);for(var a=0,u=i;a<u.length;a++){var c=u[a];l[c[0]][c[1]].color=d.Empty,b++}return E.updateScore(b),i.length>0}},updateScore:function(t){b=t,c.innerHTML=b.toString()}},w=E;addEventListener("DOMContentLoaded",(function(){w.start()}))}]);